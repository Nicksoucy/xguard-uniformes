renderError(title, message) {
                return `
                    <div class="min-h-screen flex items-center justify-center p-4 gradient-bg">
                        <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center animate-fade-in">
                            <div class="mb-6">
                                <div class="w-24 h-24 bg-gradient-to-br from-red-400 to-red-600 rounded-full flex items-center justify-center mx-auto">
                                    <svg class="w-12 h-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                            </div>
                            <h2 class="text-2xl font-bold text-gray-800 mb-4">${title}</h2>
                            <p class="text-gray-600">${message}</p>
                        </div>
                    </div>
                `;
            }

            renderEmployeesList() {
                const employees = this.db.data.employees.filter(e => e.active);
                const inactiveEmployees = this.db.data.employees.filter(e => !e.active);
                
                return `
                    <div class="min-h-screen gradient-bg">
                        <!-- Header -->
                        <div class="glass-effect shadow-lg">
                            <div class="max-w-6xl mx-auto p-4 flex justify-between items-center">
                                <h1 class="text-xl font-bold text-gray-800">Liste des employés</h1>
                                <button onclick="app.currentView='home'; app.render()" 
                                    class="p-2 hover:bg-white/20 rounded-lg transition" title="Accueil">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <div class="max-w-6xl mx-auto p-6">
                            <!-- Onglets actifs/inactifs -->
                            <div class="bg-white rounded-xl shadow-lg p-6 mb-4">
                                <div class="flex justify-between items-center mb-4">
                                    <div class="flex gap-4">
                                        <button onclick="app.showInactive = false; app.render()" 
                                            class="px-4 py-2 rounded-lg transition ${!this.showInactive ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}">
                                            <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                            </svg>
                                            Actifs (${employees.length})
                                        </button>
                                        <button onclick="app.showInactive = true; app.render()" 
                                            class="px-4 py-2 rounded-lg transition ${this.showInactive ? 'bg-gray-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}">
                                            <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                            </svg>
                                            Inactifs (${inactiveEmployees.length})
                                        </button>
                                    </div>
                                    <button onclick="app.downloadEmployeeReport()" 
                                        class="bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-2 rounded-lg hover:from-green-600 hover:to-green-700 transition">
                                        <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                        </svg>
                                        Télécharger CSV
                                    </button>
                                </div>
                            </div>

                            <div class="grid md:grid-cols-2 gap-6">
                                ${(this.showInactive ? inactiveEmployees : employees).map(emp => {
                                    const balance = this.db.getEmployeeBalance(emp.id);
                                    const totalItems = balance.reduce((sum, item) => sum + item.quantity, 0);
                                    const totalValue = balance.reduce((sum, item) => sum + (item.quantity * item.price), 0);
                                    
                                    return `
                                        <div class="bg-white rounded-xl shadow-lg p-6 hover-lift animate-fade-in ${!emp.active ? 'opacity-75' : ''}">
                                            <div class="flex justify-between items-start mb-4">
                                                <div>
                                                    <h3 class="font-semibold text-lg ${!emp.active ? 'text-gray-500' : ''}">${emp.name}</h3>
                                                    <p class="text-sm text-gray-600">${emp.id} • ${emp.phone}</p>
                                                    ${emp.email ? `<p class="text-sm text-gray-600">${emp.email}</p>` : ''}
                                                    ${!emp.active ? '<span class="inline-block mt-2 px-2 py-1 bg-gray-200 text-gray-700 rounded text-xs">Inactif</span>' : ''}
                                                </div>
                                                <div class="text-right">
                                                    <p class="text-2xl font-bold ${!emp.active ? 'text-gray-500' : 'text-gray-800'}">${totalItems}</p>
                                                    <p class="text-sm text-gray-500">articles</p>
                                                    <p class="text-sm font-semibold ${!emp.active ? 'text-gray-500' : 'text-green-600'}">${totalValue}</p>
                                                </div>
                                            </div>
                                            ${balance.length > 0 ? `
                                                <div class="border-t pt-4">
                                                    <p class="text-sm font-semibold mb-2">En possession:</p>
                                                    <div class="text-xs space-y-1 max-h-32 overflow-y-auto">
                                                        ${balance.map(item => 
                                                            `<div class="flex justify-between bg-gray-50 rounded px-2 py-1">
                                                                <span>${item.quantity}× ${item.name} (${item.size})</span>
                                                                <span class="text-gray-600">${item.price * item.quantity}</span>
                                                            </div>`
                                                        ).join('')}
                                                    </div>
                                                </div>
                                            ` : '<p class="text-sm text-gray-500 italic">Aucun article en possession</p>'}
                                            <div class="mt-4 flex gap-2">
                                                <button onclick="app.currentView='employeeDetails'; app.currentEmployee='${emp.id}'; app.render()" 
                                                    class="flex-1 bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition text-sm">
                                                    Voir détails
                                                </button>
                                                ${emp.active ? `
                                                    <button onclick="app.startTransactionForEmployee('attribution', '${emp.id}')" 
                                                        class="flex-1 bg-purple-500 text-white py-2 rounded-lg hover:bg-purple-600 transition text-sm">
                                                        Attribuer
                                                    </button>
                                                ` : `
                                                    <button onclick="app.reactivateEmployee('${emp.id}')" 
                                                        class="flex-1 bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 transition text-sm">
                                                        Réactiver
                                                    </button>
                                                `}
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    </div>
                `;
            }

            renderTransactionsList() {
                const transactions = this.db.data.transactions.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
                
                return `
                    <div class="min-h-screen gradient-bg">
                        <!-- Header -->
                        <div class="glass-effect shadow-lg">
                            <div class="max-w-6xl mx-auto p-4 flex justify-between items-center">
                                <h1 class="text-xl font-bold text-gray-800">Historique des transactions</h1>
                                <button onclick="app.currentView='home'; app.render()" 
                                    class="p-2 hover:bg-white/20 rounded-lg transition" title="Accueil">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <div class="max-w-6xl mx-auto p-6">
                            <div class="bg-white rounded-xl shadow-lg p-6 mb-4">
                                <p class="text-lg font-semibold">Total: ${transactions.length} transactions</p>
                            </div>

                            <div class="space-y-4">
                                ${transactions.map(t => {
                                    const employee = this.db.getEmployee(t.employeeId);
                                    const total = t.items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                                    const typeColor = t.type === 'attribution' ? 'blue' : t.type === 'retour' ? 'green' : 'purple';
                                    const typeText = t.type === 'attribution' ? 'Attribution' : t.type === 'retour' ? 'Retour' : 'Ajout';
                                    
                                    return `
                                        <div class="bg-white rounded-xl shadow-lg p-6 hover-lift animate-fade-in">
                                            <div class="flex justify-between items-start mb-4">
                                                <div>
                                                    <div class="flex items-center gap-3 mb-2">
                                                        <span class="px-3 py-1 bg-${typeColor}-100 text-${typeColor}-700 rounded-full text-sm font-medium">
                                                            ${typeText}
                                                        </span>
                                                        ${t.signed ? `
                                                            <span class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm">
                                                                ✓ Signé
                                                            </span>
                                                        ` : t.type !== 'retour' ? `
                                                            <span class="px-3 py-1 bg-orange-100 text-orange-700 rounded-full text-sm">
                                                                En attente
                                                            </span>
                                                        ` : ''}
                                                    </div>
                                                    <p class="font-semibold">${employee ? employee.name : 'Employé supprimé'}</p>
                                                    <p class="text-sm text-gray-600">${new Date(t.createdAt).toLocaleString('fr-CA')}</p>
                                                </div>
                                                <div class="text-right">
                                                    <p class="text-2xl font-bold ${t.type === 'retour' ? 'text-green-600' : 'text-gray-800'}">
                                                        ${t.type === 'retour' ? '-' : ''}$${total}
                                                    </p>
                                                    <p class="text-sm text-gray-500">${t.items.length} articles</p>
                                                </div>
                                            </div>
                                            <div class="border-t pt-4">
                                                <div class="flex flex-wrap gap-2">
                                                    ${t.items.map(item => `
                                                        <span class="px-2 py-1 bg-gray-100 rounded text-xs">
                                                            ${item.quantity}× ${item.name} (${item.size})
                                                        </span>
                                                    `).join('')}
                                                </div>
                                                ${t.notes ? `<p class="text-sm text-gray-600 mt-2 italic">Note: ${t.notes}</p>` : ''}
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    </div>
                `;
            }

            renderPendingSignatures() {
                const pendingLinks = this.db.data.links.filter(l => !l.used);
                const pendingTransactions = pendingLinks.map(link => ({
                    link,
                    transaction: this.db.data.transactions.find(t => t.id === link.transactionId)
                })).filter(item => item.transaction);
                
                return `
                    <div class="min-h-screen gradient-bg">
                        <!-- Header -->
                        <div class="glass-effect shadow-lg">
                            <div class="max-w-6xl mx-auto p-4 flex justify-between items-center">
                                <h1 class="text-xl font-bold text-gray-800">Signatures en attente</h1>
                                <button onclick="app.currentView='home'; app.render()" 
                                    class="p-2 hover:bg-white/20 rounded-lg transition" title="Accueil">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <div class="max-w-6xl mx-auto p-6">
                            ${pendingTransactions.length === 0 ? `
                                <div class="bg-white rounded-xl shadow-lg p-12 text-center">
                                    <div class="w-24 h-24 bg-gradient-to-br from-green-100 to-green-200 rounded-full flex items-center justify-center mx-auto mb-4">
                                        <svg class="w-12 h-12 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                        </svg>
                                    </div>
                                    <h2 class="text-xl font-semibold text-gray-800 mb-2">Aucune signature en attente</h2>
                                    <p class="text-gray-600">Toutes les transactions ont été signées</p>
                                </div>
                            ` : `
                                <div class="bg-white rounded-xl shadow-lg p-6 mb-4">
                                    <p class="text-lg font-semibold text-orange-600">${pendingTransactions.length} signatures en attente</p>
                                </div>

                                <div class="space-y-4">
                                    ${pendingTransactions.map(({ link, transaction }) => {
                                        const employee = this.db.getEmployee(transaction.employeeId);
                                        const total = transaction.items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                                        const linkUrl = `${window.location.origin}${window.location.pathname}?token=${link.token}`;
                                        const daysAgo = Math.floor((new Date() - new Date(transaction.createdAt)) / (1000 * 60 * 60 * 24));
                                        
                                        return `
                                            <div class="bg-white rounded-xl shadow-lg p-6 hover-lift animate-fade-in border-l-4 border-orange-500">
                                                <div class="flex justify-between items-start mb-4">
                                                    <div>
                                                        <p class="font-semibold text-lg">${employee ? employee.name : 'Employé supprimé'}</p>
                                                        <p class="text-sm text-gray-600">Créé il y a ${daysAgo} jour${daysAgo > 1 ? 's' : ''}</p>
                                                        <p class="text-sm text-gray-600">${new Date(transaction.createdAt).toLocaleString('fr-CA')}</p>
                                                    </div>
                                                    <div class="text-right">
                                                        <p class="text-2xl font-bold text-gray-800">$${total}</p>
                                                        <p class="text-sm text-gray-500">${transaction.items.length} articles</p>
                                                    </div>
                                                </div>
                                                <div class="border-t pt-4 mb-4">
                                                    <div class="flex flex-wrap gap-2">
                                                        ${transaction.items.map(item => `
                                                            <span class="px-2 py-1 bg-gray-100 rounded text-xs">
                                                                ${item.quantity}× ${item.name} (${item.size})
                                                            </span>
                                                        `).join('')}
                                                    </div>
                                                </div>
                                                <div class="bg-orange-50 rounded-lg p-4">
                                                    <p class="text-sm font-semibold mb-2">Lien de signature:</p>
                                                    <div class="flex items-center gap-2">
                                                        <input type="text" value="${linkUrl}" readonly 
                                                            class="flex-1 px-3 py-2 bg-white border rounded-lg text-xs">
                                                        <button onclick="app.copyLink('${linkUrl}')" 
                                                            class="bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition">
                                                            Copier
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        `;
                                    }).join('')}
                                </div>
                            `}
                        </div>
                    </div>
                `;
            }

            renderLowStock() {
                const lowStockItems = this.db.data.inventory.filter(item => 
                    Object.values(item.sizes).some(qty => qty < 10)
                );
                
                return `
                    <div class="min-h-screen gradient-bg">
                        <!-- Header -->
                        <div class="glass-effect shadow-lg">
                            <div class="max-w-6xl mx-auto p-4 flex justify-between items-center">
                                <h1 class="text-xl font-bold text-gray-800">Articles en stock faible</h1>
                                <button onclick="app.currentView='home'; app.render()" 
                                    class="p-2 hover:bg-white/20 rounded-lg transition" title="Accueil">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <div class="max-w-6xl mx-auto p-6">
                            <div class="bg-white rounded-xl shadow-lg p-6 mb-4">
                                <div class="flex justify-between items-center">
                                    <p class="text-lg font-semibold text-red-600">${lowStockItems.length} articles avec stock faible</p>
                                    <button onclick="app.downloadInventoryReport()" 
                                        class="bg-gradient-to-r from-red-500 to-red-600 text-white px-4 py-2 rounded-lg hover:from-red-600 hover:to-red-700 transition">
                                        <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                        </svg>
                                        Télécharger inventaire
                                    </button>
                                </div>
                            </div>

                            <div class="grid md:grid-cols-2 gap-6">
                                ${lowStockItems.map(item => {
                                    const totalStock = Object.values(item.sizes).reduce((sum, qty) => sum + qty, 0);
                                    const criticalSizes = Object.entries(item.sizes).filter(([size, qty]) => qty < 10);
                                    const outOfStock = Object.entries(item.sizes).filter(([size, qty]) => qty === 0);
                                    
                                    return `
                                        <div class="bg-white rounded-xl shadow-lg p-6 hover-lift animate-fade-in border-l-4 ${totalStock < 10 ? 'border-red-500' : 'border-orange-500'}">
                                            <div class="flex justify-between items-start mb-4">
                                                <h3 class="font-semibold text-lg">${item.name}</h3>
                                                <div class="text-right">
                                                    <p class="text-sm text-gray-500">Stock total</p>
                                                    <p class="text-3xl font-bold ${totalStock < 10 ? 'text-red-600' : 'text-orange-600'}">${totalStock}</p>
                                                </div>
                                            </div>
                                            
                                            ${outOfStock.length > 0 ? `
                                                <div class="bg-red-50 rounded-lg p-3 mb-3">
                                                    <p class="text-sm font-semibold text-red-700 mb-1">Rupture de stock:</p>
                                                    <div class="flex flex-wrap gap-2">
                                                        ${outOfStock.map(([size]) => `
                                                            <span class="px-2 py-1 bg-red-100 text-red-700 rounded text-xs font-medium">
                                                                ${size}
                                                            </span>
                                                        `).join('')}
                                                    </div>
                                                </div>
                                            ` : ''}
                                            
                                            <div class="bg-orange-50 rounded-lg p-3">
                                                <p class="text-sm font-semibold text-orange-700 mb-1">Stock faible:</p>
                                                <div class="flex flex-wrap gap-2">
                                                    ${criticalSizes.map(([size, qty]) => `
                                                        <span class="px-3 py-1 ${qty === 0 ? 'bg-red-100 text-red-700' : 'bg-orange-100 text-orange-700'} rounded-full text-sm font-medium">
                                                            ${size}: ${qty}
                                                        </span>
                                                    `).join('')}
                                                </div>
                                            </div>
                                            
                                            <div class="mt-4 pt-4 border-t">
                                                <p class="text-sm text-gray-600">Prix unitaire: <span class="font-semibold">$${item.price}</span></p>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    </div>
                `;
            }

            renderEmployeeDetails() {
                const employee = this.db.getEmployee(this.currentEmployee);
                if (!employee) {
                    return this.renderError('Employé introuvable', 'Cet employé n\'existe pas.');
                }

                const transactions = this.db.getEmployeeTransactions(this.currentEmployee);
                const balance = this.db.getEmployeeBalance(this.currentEmployee);
                const totalValue = balance.reduce((sum, item) => sum + (item.quantity * item.price), 0);
                
                return `
                    <div class="min-h-screen gradient-bg">
                        <!-- Header -->
                        <div class="glass-effect shadow-lg">
                            <div class="max-w-6xl mx-auto p-4 flex justify-between items-center">
                                <h1 class="text-xl font-bold text-gray-800">Détails de l'employé</h1>
                                <div class="flex gap-2">
                                    <button onclick="app.currentView='employees'; app.render()" 
                                        class="p-2 hover:bg-white/20 rounded-lg transition" title="Retour">
                                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                                        </svg>
                                    </button>
                                    <button onclick="app.currentView='home'; app.render()" 
                                        class="p-2 hover:bg-white/20 rounded-lg transition" title="Accueil">
                                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="max-w-6xl mx-auto p-6">
                            <!-- Info employé -->
                            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h2 class="text-2xl font-bold mb-2">${employee.name}</h2>
                                        <p class="text-gray-600">${employee.id}</p>
                                        <p class="text-gray-600">${employee.phone}</p>
                                        ${employee.email ? `<p class="text-gray-600">${employee.email}</p>` : ''}
                                        ${employee.notes ? `<p class="text-sm text-gray-500 mt-2 italic">${employee.notes}</p>` : ''}
                                        ${!employee.active ? '<span class="inline-block mt-2 px-3 py-1 bg-gray-200 text-gray-700 rounded">Employé inactif</span>' : ''}
                                    </div>
                                    <div class="text-right">
                                        <p class="text-sm text-gray-500">Valeur totale</p>
                                        <p class="text-3xl font-bold text-green-600">${totalValue}</p>
                                        <p class="text-sm text-gray-500 mt-2">${balance.length} articles</p>
                                    </div>
                                </div>
                                <div class="mt-4 flex gap-2">
                                    ${employee.active ? `
                                        <button onclick="app.startTransactionForEmployee('attribution', '${employee.id}')" 
                                            class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition">
                                            Attribution
                                        </button>
                                        <button onclick="app.startTransactionForEmployee('retour', '${employee.id}')" 
                                            class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition">
                                            Retour
                                        </button>
                                        <button onclick="app.startTransactionForEmployee('ajout', '${employee.id}')" 
                                            class="bg-purple-500 text-white px-4 py-2 rounded-lg hover:bg-purple-600 transition">
                                            Ajout
                                        </button>
                                        ${balance.length === 0 ? `
                                            <button onclick="app.deactivateEmployee('${employee.id}')" 
                                                class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition ml-auto">
                                                <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"></path>
                                                </svg>
                                                Désactiver l'employé
                                            </button>
                                        ` : ''}
                                    ` : `
                                        <button onclick="app.reactivateEmployee('${employee.id}')" 
                                            class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition">
                                            <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                            </svg>
                                            Réactiver l'employé
                                        </button>
                                    `}
                                </div>
                                ${employee.active && balance.length > 0 ? `
                                    <div class="mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                                        <p class="text-sm text-yellow-800">
                                            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                                            </svg>
                                            L'employé doit retourner tous ses articles avant d'être désactivé
                                        </p>
                                    </div>
                                ` : ''}
                            </div>

                            <!-- Inventaire actuel -->
                            ${balance.length > 0 ? `
                                <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                                    <h3 class="text-xl font-semibold mb-4">Articles en possession</h3>
                                    <div class="grid md:grid-cols-2 gap-3">
                                        ${balance.map(item => `
                                            <div class="bg-gray-50 rounded-lg p-4">
                                                <div class="flex justify-between items-center">
                                                    <div>
                                                        <span class="font-medium">${item.name}</span>
                                                        <span class="text-sm text-gray-600 ml-2">Taille: ${item.size}</span>
                                                    </div>
                                                    <div class="text-right">
                                                        <span class="text-lg font-bold">${item.quantity}</span>
                                                        <span class="text-sm text-gray-600 ml-1">× ${item.price}</span>
                                                    </div>
                                                </div>
                                                <p class="text-sm text-green-600 font-semibold mt-1">${item.quantity * item.price}</p>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}

                            <!-- Historique -->
                            <div class="bg-white rounded-xl shadow-lg p-6">
                                <h3 class="text-xl font-semibold mb-4">Historique des transactions</h3>
                                ${transactions.length > 0 ? `
                                    <div class="space-y-3">
                                        ${transactions.map(t => {
                                            const total = t.items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                                            const typeColor = t.type === 'attribution' ? 'blue' : t.type === 'retour' ? 'green' : 'purple';
                                            const typeText = t.type === 'attribution' ? 'Attribution' : t.type === 'retour' ? 'Retour' : 'Ajout';
                                            
                                            return `
                                                <div class="border rounded-lg p-4">
                                                    <div class="flex justify-between items-start mb-2">
                                                        <div>
                                                            <span class="px-2 py-1 bg-${typeColor}-100 text-${typeColor}-700 rounded text-sm font-medium">
                                                                ${typeText}
                                                            </span>
                                                            ${t.signed ? `
                                                                <span class="ml-2 px-2 py-1 bg-green-100 text-green-700 rounded text-sm">
                                                                    ✓ Signé
                                                                </span>
                                                            ` : ''}
                                                        </div>
                                                        <p class="text-sm text-gray-600">${new Date(t.createdAt).toLocaleString('fr-CA')}</p>
                                                    </div>
                                                    <div class="flex flex-wrap gap-2 mb-2">
                                                        ${t.items.map(item => `
                                                            <span class="px-2 py-1 bg-gray-100 rounded text-xs">
                                                                ${item.quantity}× ${item.name} (${item.size})
                                                            </span>
                                                        `).join('')}
                                                    </div>
                                                    <p class="text-right font-semibold ${t.type === 'retour' ? 'text-green-600' : ''}">
                                                        ${t.type === 'retour' ? '-' : '+'}${total}
                                                    </p>
                                                    ${t.notes ? `<p class="text-sm text-gray-600 mt-2 italic">Note: ${t.notes}</p>` : ''}
                                                </div>
                                            `;
                                        }).join('')}
                                    </div>
                                ` : '<p class="text-gray-500 text-center py-8">Aucune transaction</p>'}
                            </div>
                        </div>
                    </div>
                `;
            }
